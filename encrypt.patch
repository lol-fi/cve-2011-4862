--- encrypt.c	2018-11-19 11:40:09.632626796 -0500
+++ fixencrypt.c	2018-11-19 11:52:05.868626796 -0500
@@ -798,6 +798,12 @@
   int dir = kp->dir;
   register int ret = 0;
 
+  if (len > MAXKEYLEN) {
+      //set len to 0. This will fall into
+      //"empty option, indicates a failure"
+      //in following statement
+      len = 0;
+  }
 
   if (!(ep = (*kp->getcrypt) (*kp->modep)))
     {
